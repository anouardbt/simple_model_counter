# Simple dbt Model Counter

A Python script to count the number of dbt models built from `run_results.json` files. Can process single files or analyze multiple files from folders for trend analysis.

## Features

- **Single File Analysis**: Detailed analysis of one `run_results.json` file
- **Multi-File Analysis**: Process entire folders containing multiple run results
- **Summary Tables**: Clean tabular output showing models built across multiple runs
- **JSON Output**: Machine-readable output for automation and integration
- **Recursive Search**: Find run_results.json files in subdirectories
- **Performance Metrics**: Execution times and success rates
- **Verbose Mode**: Detailed processing information

## Installation

No additional dependencies required - uses only Python standard library.

```bash
git clone https://github.com/anouardbt/simple_model_counter.git
cd simple_model_counter
```

## Usage

### Basic Usage

```bash
# Analyze a single run_results.json file
python3 simple_model_counter.py run_results.json

# Analyze all run_results.json files in a folder
python3 simple_model_counter.py ./dbt_logs/

# Recursive search through subdirectories
python3 simple_model_counter.py . --recursive

# Output as JSON for automation
python3 simple_model_counter.py folder/ --json

# Show detailed processing information
python3 simple_model_counter.py folder/ --verbose
```

### Command Line Options

```
usage: simple_model_counter.py [-h] [--json] [--recursive] [--verbose] [path]

positional arguments:
  path             Path to run_results.json file or folder containing them

options:
  --json           Output results as JSON
  --recursive, -r  Search recursively in subdirectories  
  --verbose, -v    Show detailed processing information
```

## Output Examples

### Single File Analysis
```
============================================================
dbt MODEL BUILD COUNT
============================================================

File: run_results.json
Date: 2025-08-12
dbt Version: 2025.8.5+56e45b2
Timestamp: 2025-08-12T00:01:59.117490Z

Model Statistics:
  Total Models Built: 35
  Successful: 35
  Failed: 0
  Success Rate: 100.0%

Performance:
  Average Execution Time: 0.413 seconds
  Total Execution Time: 14.445 seconds
```

### Multiple Files Analysis
```
================================================================================
dbt MODEL BUILD SUMMARY
================================================================================

File                           Date         Models  Success  Time(s) 
--------------------------------------------------------------------------------
run_results_2025-08-12.json    2025-08-12   35       100.0%   14.45
run_results_2025-08-11.json    2025-08-11   42       95.2%    18.23
run_results_2025-08-10.json    2025-08-10   38       100.0%   16.12
--------------------------------------------------------------------------------
TOTAL                          All Dates    115      98.3%    48.80

Overall Statistics:
  Total Runs Analyzed: 3
  Total Models Built: 115
  Average Models per Run: 38.3
  Overall Success Rate: 98.3%
  Total Execution Time: 48.80 seconds
```

### JSON Output
```json
[
  {
    "file_path": "run_results.json",
    "run_date": "2025-08-12",
    "run_timestamp": "2025-08-12T00:01:59.117490Z",
    "dbt_version": "2025.8.5+56e45b2",
    "invocation_id": "5a9a95b4-1e31-4eb0-aabc-5b92b14ddc17",
    "total_models": 35,
    "successful_models": 35,
    "failed_models": 0,
    "success_rate": 100.0,
    "avg_execution_time": 0.413,
    "total_execution_time": 14.445
  }
]
```

## Use Cases

- **dbt Platform**: Calculate dbt Successful Models Built

## File Structure

The script looks for `run_results.json` files which are generated by dbt in the `target/` directory after running commands like:


## Integration Examples

### Monitoring Multiple Environments
```bash
# Analyze all environments
python3 simple_model_counter.py ./logs/ --recursive --json > daily_report.json
```

## Contributing

Feel free to open issues or submit pull requests to improve the functionality.

## License

MIT License - feel free to use and modify as needed.
